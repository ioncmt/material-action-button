{"version":3,"sources":["ion-action-button.js"],"names":["actionButtonFactory","$rootScope","$compile","$ionicBody","$animate","$ionicTabsDelegate","actionButton","options","scope","$new","visible","removeOnStateChange","bottom","hasTab","menuBottom","menuOpened","mainButtonElement","secondaryButtonsContainer","element","append","remove","$destroy","removeButton","removed","addClass","then","buttonClicked","data","type","openMenu","mainAction","onClick","ngEvent","removeClass","buttons","index","show","angular","getElementsByClassName","startHidden","showButton","hideButton","unSubscribeStateChangeEvent","$on","hide","create","module","factory","component","templateUrl","bindings","dispatcher","onCreate","controller","$timeout","_this","this","closeMenu","$postLink","length","run","$templateCache","put"],"mappings":"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","file":"../ion-action-button.js","sourcesContent":["/**\n * Private method doing the factory\n */\nfunction actionButtonFactory($rootScope, $compile, $ionicBody, $animate, $ionicTabsDelegate) {\n  return {\n    create: actionButton\n  };\n\n  function actionButton(options) {\n    var scope = $rootScope.$new(true);\n    var visible = true;\n    scope.options = options;\n    scope.options.removeOnStateChange = true;\n    scope.options.bottom = scope.options.hasTab ? '55px' : '15px';\n    scope.options.menuBottom = scope.options.hasTab ? '115px' : '90px';\n    scope.menuOpened = false;\n    // Compile the template\n    var element = scope.element = $compile(\n      '<material-action-button on-create=\"show()\" options=\"options\" dispatcher=\"buttonClicked(data)\"></material-action-button>'\n    )(scope);\n    var mainButtonElement;\n    var secondaryButtonsContainer;\n    //append to the body\n    $ionicBody.append(element);\n    var remove = function() {\n      visible = false;\n      scope.$destroy();\n      element.remove();\n    };\n    /**\n     * Button remove\n     */\n    scope.removeButton = function() {\n      if (scope.removed) {\n        return;\n      }\n      scope.removed = true;\n      if (mainButtonElement) {\n        return $animate.addClass(mainButtonElement, 'action-button-hide').then(function() {\n          remove();\n          return;\n        });\n      } else {\n        remove();\n      }\n    };\n    /**\n     * Button clicked\n     */\n    scope.buttonClicked = function(data) {\n      //we handle main button clicks\n      if (data.type === 'main') {\n        //if we have secondary actions...\n        if (data.openMenu) {\n          //if menu is opened, we close it\n          if (scope.menuOpened) {\n            element.removeClass('action-button-menu-show');\n            element.addClass('action-button-menu-hide');\n            $animate.addClass(secondaryButtonsContainer, 'action-button-small-hide').then(function() {\n              secondaryButtonsContainer.removeClass('action-button-small-show');\n              secondaryButtonsContainer.removeClass('action-button-small-hide');\n              secondaryButtonsContainer.addClass('action-button-small-container__hidden');\n              scope.menuOpened = false;\n            });\n          } else {\n            //if menu is closed, we open it\n            element.removeClass('action-button-menu-hide');\n            element.addClass('action-button-menu-show');\n            secondaryButtonsContainer.removeClass('action-button-small-container__hidden');\n            $animate.addClass(secondaryButtonsContainer, 'action-button-small-show').then(function() {\n              scope.menuOpened = true;\n            });\n          }\n        } else {\n          //if we don't have secondary actions\n          if (scope.options.mainAction.onClick) {\n            return scope.options.mainAction.onClick(data.ngEvent);\n          }\n          return;\n        }\n      }\n      if (data.type === 'secondary') {\n        if (scope.options.buttons[data.index].onClick) {\n          return scope.options.buttons[data.index].onClick(data.ngEvent, data.index);\n        }\n        return;\n      }\n    };\n    /**\n     * Show the menu\n     */\n    scope.show = function() {\n      $animate.addClass(element, 'button-active') //hack to wait till the element is appended? dont know...\n        .then(function() {\n          visible = true;\n          mainButtonElement = angular.element(element[0].getElementsByClassName('action-button'));\n          secondaryButtonsContainer = angular.element(element[0].getElementsByClassName(\n            'action-button-small-container'));\n          if (scope.options.startHidden) {\n            return;\n          }\n          return $animate.addClass(mainButtonElement, 'action-button-show');\n        });\n    };\n    scope.showButton = function() {\n      return $animate.addClass(mainButtonElement, 'action-button-show').then(function() {\n        visible = true;\n        return;\n      });\n    };\n    scope.hideButton = function() {\n      return $animate.addClass(mainButtonElement, 'action-button-hide').then(function() {\n        mainButtonElement.removeClass('action-button-show');\n        mainButtonElement.removeClass('action-button-hide');\n        element.removeClass('action-button-menu-hide');\n        visible = false;\n        return;\n      });\n    };\n    //auto remove when state changes\n    var unSubscribeStateChangeEvent = $rootScope.$on('$stateChangeStart', function() {\n      if (scope.options.removeOnStateChange) {\n        scope.removeButton();\n        unSubscribeStateChangeEvent();\n        return;\n      }\n    });\n    return {\n      show: function() {\n        return scope.showButton();\n      },\n      hide: function() {\n        return scope.hideButton();\n      },\n      visible: function() {\n        return visible;\n      }\n    };\n  }\n}\n/**\n * Action Button module is initialized here\n */\nangular.module('$actionButton', ['ngAnimate'])\n  .factory('$actionButton', [\n    '$rootScope',\n    '$compile',\n    '$ionicBody',\n    '$animate',\n    '$ionicTabsDelegate',\n    actionButtonFactory\n  ])\n  .component('materialActionButton', {\n    templateUrl: 'template.html',\n    bindings: {\n      options: '<',\n      dispatcher: '&',\n      onCreate: '&'\n    },\n    controller: [\n      '$timeout',\n      function($timeout) {\n        var _this = this;\n        // this.opened = false;\n        this.closeMenu = function(data) {\n          //we simulate a main button touch order to close\n          data.openMenu = true;\n          _this.dispatcher({\n            data: data\n          });\n          return;\n        };\n        this.$postLink = function() {\n          $timeout(function() {\n            _this.onCreate();\n          });\n        };\n        this.buttonClicked = function(data) {\n          //if the element has no buttons configured...\n          if (!_this.options.buttons || !_this.options.buttons.length) {\n            _this.dispatcher({\n              data: data\n            });\n            return;\n          }\n          //if the element has buttons configured...\n          //we pass the openMenu true prop...\n          if (data.type === 'main') {\n            data.openMenu = true;\n            _this.dispatcher({\n              data: data\n            });\n            return;\n          }\n          //any other click here has to be from a small button\n          _this.dispatcher({\n            data: data\n          });\n        };\n      }\n    ]\n  });\nangular.module(\"$actionButton\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"template.html\",\"<div ng-animate-children=\\\"true\\\">\\r\\n\t<div class=\\\"action-button-small-container\\\" ng-click=\\\"$ctrl.closeMenu({type: \\'main\\', backgroundClick: true})\\\" ng-style=\\\"{\\'padding-bottom\\':$ctrl.options.menuBottom}\\\">\\r\\n\t\t<div class=\\\"action-button-small-container--individual\\\" ng-repeat=\\\"button in $ctrl.options.buttons\\\" ng-attr-id=\\\"{{button.id}}\\\" ng-click=\\\"$ctrl.buttonClicked({ngEvent:$event, type: \\'secondary\\', index: $index})\\\">\\r\\n\t\t\t<span class=\\\"action-button-small--label\\\" ng-if=\\\"button.label\\\">{{button.label}}</span>\\r\\n\t\t\t<button class=\\\"action-button-small\\\" ng-class=\\\"{\\'destructive\\': button.destructive}\\\">\\r\\n\t\t\t\t<i class=\\\"action-button-small--icon icon\\\" ng-class=\\\"button.icon\\\"><span class=\\\"action-button-small--icon__label\\\" ng-if=\\\"!button.icon\\\">{{button.letter || button.label[0]}}</span></i>\\r\\n\t\t\t</button>\\r\\n\t\t</div>\\r\\n\t</div>\\r\\n\t<button ng-attr-id=\\\"{{$ctrl.options.mainAction.id}}\\\" class=\\\"action-button\\\" ng-click=\\\"$ctrl.buttonClicked({ngEvent:$event, type: \\'main\\'})\\\" ng-style=\\\"{bottom:$ctrl.options.bottom}\\\">\\r\\n\t\t<i class=\\'action-button--icon icon action-button--icon__main\\' ng-class=\\\"$ctrl.options.mainAction.icon\\\"></i>\\r\\n\t\t<i class=\\'action-button--icon action-button-icon__close\\' ng-class=\\\"$ctrl.options.mainAction.closeIcon\\\"></i>\\r\\n\t</button>\\r\\n</div>\\r\\n\");}]);"]}